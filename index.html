<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixed English Learning System - å®Œå…¨å‹•ä½œç‰ˆè‹±èªå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ </title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .emi-character {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1000;
            background: linear-gradient(45deg, #ff6b9d, #ffa726);
            border-radius: 50%;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            box-shadow: 0 10px 30px rgba(255, 107, 157, 0.3);
            cursor: pointer;
        }
        .emi-speech {
            position: fixed;
            right: 160px;
            top: 45%;
            transform: translateY(-50%);
            z-index: 999;
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            max-width: 280px;
            border: 2px solid #ff6b9d;
        }
        .level-progress {
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }
        .level-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #34d399);
            transition: width 0.5s ease;
        }
        select {
            background-color: #374151 !important;
            color: white !important;
            border: 1px solid #4b5563 !important;
        }
        select option {
            background-color: #374151 !important;
            color: white !important;
        }
        .question-card {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border-left: 4px solid #3b82f6;
        }
        .correct-answer {
            background-color: #10b981 !important;
            color: white !important;
        }
        .wrong-answer {
            background-color: #ef4444 !important;
            color: white !important;
        }
        @media (max-width: 768px) {
            .emi-character {
                width: 80px;
                height: 80px;
                font-size: 32px;
                right: 10px;
            }
            .emi-speech {
                right: 100px;
                max-width: 200px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold"><i class="fas fa-graduation-cap mr-3"></i>English Learning System</h1>
                    <p class="text-blue-100 mt-2">AI-powered adaptive learning with character guide</p>
                </div>
                <div class="text-right">
                    <div class="text-sm text-blue-100">Current Level</div>
                    <div class="text-xl font-bold" id="currentLevel">æœªè¨ºæ–­</div>
                    <div class="level-progress mt-2">
                        <div class="level-progress-bar" id="levelProgressBar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Emi Character Guide -->
    <div class="emi-character" id="emiCharacter">
        ğŸ±
    </div>
    <div class="emi-speech" id="emiSpeech" style="display: none;">
        <div class="text-sm font-medium text-gray-800" id="emiMessage">
            ã“ã‚“ã«ã¡ã¯ï¼ç§ã¯ã‚¨ãƒŸâœ¨<br>
            ã‚ãªãŸã®è‹±èªå­¦ç¿’ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ï¼<br>
            ã¾ãšã¯ãƒ¬ãƒ™ãƒ«è¨ºæ–­ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ï¼
        </div>
        <div class="absolute -right-2 top-1/2 transform -translate-y-1/2 w-0 h-0 border-l-8 border-r-0 border-t-8 border-b-8 border-l-pink-400 border-t-transparent border-b-transparent"></div>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Level Diagnosis Section -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8" id="levelDiagnosisSection">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">
                <i class="fas fa-chart-line text-blue-500 mr-3"></i>ãƒ¬ãƒ™ãƒ«è¨ºæ–­
            </h2>
            <div id="diagnosisStart" class="text-center">
                <p class="text-gray-600 mb-6">5ã¤ã®è³ªå•ã§ã‚ãªãŸã®è‹±èªãƒ¬ãƒ™ãƒ«ã‚’è¨ºæ–­ã—ã¾ã™ã€‚è¨ºæ–­çµæœã«åŸºã¥ã„ã¦ã€æœ€é©ãªå­¦ç¿’å†…å®¹ã‚’æä¾›ã—ã¾ã™ã€‚</p>
                <button onclick="startLevelDiagnosis()" class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-lg font-medium transition-colors">
                    <i class="fas fa-play mr-2"></i>ãƒ¬ãƒ™ãƒ«è¨ºæ–­ã‚’é–‹å§‹
                </button>
            </div>
            <div id="diagnosisQuestions" style="display: none;"></div>
            <div id="diagnosisResult" style="display: none;"></div>
        </div>

        <!-- Learning Dashboard -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Vocabulary Learning -->
            <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
                <div class="text-center">
                    <div class="text-4xl mb-4">ğŸ“š</div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">å˜èªå­¦ç¿’</h3>
                    <select id="vocabularyLevel" class="w-full p-2 rounded-lg mb-4">
                        <option value="beginner">åˆç´š (300èª)</option>
                        <option value="intermediate">ä¸­ç´š (400èª)</option>
                        <option value="advanced">ä¸Šç´š (300èª)</option>
                    </select>
                    <select id="vocabularyCategory" class="w-full p-2 rounded-lg mb-4">
                        <option value="business">ãƒ“ã‚¸ãƒã‚¹</option>
                        <option value="daily">æ—¥å¸¸ç”Ÿæ´»</option>
                        <option value="emotions">æ„Ÿæƒ…è¡¨ç¾</option>
                        <option value="trend">ãƒˆãƒ¬ãƒ³ãƒ‰</option>
                    </select>
                    <button onclick="getNewWord()" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg transition-colors">
                        <i class="fas fa-refresh mr-2"></i>æ–°ã—ã„å˜èª
                    </button>
                </div>
            </div>

            <!-- Native Phrases -->
            <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
                <div class="text-center">
                    <div class="text-4xl mb-4">ğŸ’¬</div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ•ãƒ¬ãƒ¼ã‚º</h3>
                    <select id="phraseCategory" class="w-full p-2 rounded-lg mb-4">
                        <option value="daily">æ—¥å¸¸ä¼šè©± (200ãƒ•ãƒ¬ãƒ¼ã‚º)</option>
                        <option value="business">ãƒ“ã‚¸ãƒã‚¹ (150ãƒ•ãƒ¬ãƒ¼ã‚º)</option>
                        <option value="slang">ã‚¹ãƒ©ãƒ³ã‚° (150ãƒ•ãƒ¬ãƒ¼ã‚º)</option>
                    </select>
                    <button onclick="getNewPhrase()" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded-lg transition-colors">
                        <i class="fas fa-refresh mr-2"></i>æ–°ã—ã„ãƒ•ãƒ¬ãƒ¼ã‚º
                    </button>
                </div>
            </div>

            <!-- Quick Test -->
            <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
                <div class="text-center">
                    <div class="text-4xl mb-4">âš¡</div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ</h3>
                    <select id="testQuestionCount" class="w-full p-2 rounded-lg mb-4">
                        <option value="5">5å•ãƒ†ã‚¹ãƒˆ</option>
                        <option value="10">10å•ãƒ†ã‚¹ãƒˆ</option>
                        <option value="20">20å•ãƒ†ã‚¹ãƒˆ</option>
                    </select>
                    <button onclick="startQuickTest()" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg transition-colors">
                        <i class="fas fa-bolt mr-2"></i>ãƒ†ã‚¹ãƒˆé–‹å§‹
                    </button>
                </div>
            </div>

            <!-- Progress -->
            <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
                <div class="text-center">
                    <div class="text-4xl mb-4">ğŸ“Š</div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">å­¦ç¿’è¨˜éŒ²</h3>
                    <div class="text-2xl font-bold text-blue-500" id="todayWords">0</div>
                    <div class="text-sm text-gray-600">ä»Šæ—¥ã®æ–°å˜èª</div>
                    <div class="text-2xl font-bold text-purple-500 mt-2" id="studyStreak">0</div>
                    <div class="text-sm text-gray-600">é€£ç¶šå­¦ç¿’æ—¥æ•°</div>
                </div>
            </div>
        </div>

        <!-- Content Display Area -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Vocabulary Display -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">
                    <i class="fas fa-book text-green-500 mr-2"></i>ä»Šæ—¥ã®å˜èª
                </h3>
                <div id="vocabularyContent" class="text-center text-gray-500 py-8">
                    ã€Œæ–°ã—ã„å˜èªã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å­¦ç¿’ã‚’é–‹å§‹ã—ã¾ã—ã‚‡ã†ï¼
                </div>
            </div>

            <!-- Phrase Display -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">
                    <i class="fas fa-comments text-purple-500 mr-2"></i>ä»Šæ—¥ã®ãƒ•ãƒ¬ãƒ¼ã‚º
                </h3>
                <div id="phraseContent" class="text-center text-gray-500 py-8">
                    ã€Œæ–°ã—ã„ãƒ•ãƒ¬ãƒ¼ã‚ºã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å­¦ç¿’ã‚’é–‹å§‹ã—ã¾ã—ã‚‡ã†ï¼
                </div>
            </div>
        </div>

        <!-- Quick Test Area -->
        <div class="bg-white rounded-lg shadow-lg p-6" id="quickTestArea" style="display: none;">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">
                <i class="fas fa-clipboard-check text-orange-500 mr-2"></i>ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ
            </h3>
            <div id="testContent"></div>
        </div>

        <!-- Stats Dashboard -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">
                <i class="fas fa-chart-bar text-blue-500 mr-2"></i>å­¦ç¿’çµ±è¨ˆ
            </h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                    <div class="text-2xl font-bold text-blue-600" id="totalWords">0</div>
                    <div class="text-sm text-gray-600">ç·å­¦ç¿’å˜èªæ•°</div>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <div class="text-2xl font-bold text-purple-600" id="totalPhrases">0</div>
                    <div class="text-sm text-gray-600">ç·å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ã‚ºæ•°</div>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <div class="text-2xl font-bold text-green-600" id="testScore">0%</div>
                    <div class="text-sm text-gray-600">å¹³å‡ãƒ†ã‚¹ãƒˆã‚¹ã‚³ã‚¢</div>
                </div>
                <div class="text-center p-4 bg-orange-50 rounded-lg">
                    <div class="text-2xl font-bold text-orange-600" id="totalTests">0</div>
                    <div class="text-sm text-gray-600">ãƒ†ã‚¹ãƒˆå®Ÿæ–½å›æ•°</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Storage
        let vocabulary = {
            beginner: {
                business: [
                    {word: "meeting", meaning: "ä¼šè­°", example: "We have a team meeting at 2 PM.", level: "beginner"},
                    {word: "deadline", meaning: "ç· åˆ‡", example: "The project deadline is next Friday.", level: "beginner"},
                    {word: "presentation", meaning: "ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³", example: "I need to prepare for tomorrow's presentation.", level: "beginner"},
                    {word: "schedule", meaning: "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«", example: "Let me check my schedule for next week.", level: "beginner"},
                    {word: "budget", meaning: "äºˆç®—", example: "We need to stay within the budget.", level: "beginner"},
                    {word: "client", meaning: "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ", example: "The client was very satisfied with our service.", level: "beginner"},
                    {word: "contract", meaning: "å¥‘ç´„", example: "Please review the contract before signing.", level: "beginner"},
                    {word: "invoice", meaning: "è«‹æ±‚æ›¸", example: "I'll send you the invoice by email.", level: "beginner"},
                    {word: "profit", meaning: "åˆ©ç›Š", example: "The company made a good profit this year.", level: "beginner"},
                    {word: "salary", meaning: "çµ¦æ–™", example: "My salary is paid monthly.", level: "beginner"},
                    {word: "manager", meaning: "ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼", example: "I need to discuss this with my manager.", level: "beginner"},
                    {word: "employee", meaning: "å¾“æ¥­å“¡", example: "All employees must attend the training.", level: "beginner"},
                    {word: "office", meaning: "ã‚ªãƒ•ã‚£ã‚¹", example: "I work in a modern office building.", level: "beginner"},
                    {word: "computer", meaning: "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼", example: "My computer crashed during the presentation.", level: "beginner"},
                    {word: "email", meaning: "Eãƒ¡ãƒ¼ãƒ«", example: "Please send me an email with the details.", level: "beginner"},
                    {word: "report", meaning: "ãƒ¬ãƒãƒ¼ãƒˆ", example: "The monthly report is due tomorrow.", level: "beginner"},
                    {word: "project", meaning: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ", example: "This project will take three months.", level: "beginner"},
                    {word: "team", meaning: "ãƒãƒ¼ãƒ ", example: "Our team works very well together.", level: "beginner"},
                    {word: "department", meaning: "éƒ¨é–€", example: "Which department do you work in?", level: "beginner"},
                    {word: "company", meaning: "ä¼šç¤¾", example: "I've been with this company for five years.", level: "beginner"}
                ],
                daily: [
                    {word: "breakfast", meaning: "æœé£Ÿ", example: "I usually have toast for breakfast.", level: "beginner"},
                    {word: "grocery", meaning: "é£Ÿæ–™å“", example: "I need to go grocery shopping today.", level: "beginner"},
                    {word: "apartment", meaning: "ã‚¢ãƒ‘ãƒ¼ãƒˆ", example: "I live in a small apartment downtown.", level: "beginner"},
                    {word: "neighbor", meaning: "è¿‘æ‰€ã®äºº", example: "My neighbor is very friendly.", level: "beginner"},
                    {word: "weather", meaning: "å¤©æ°—", example: "The weather is beautiful today.", level: "beginner"},
                    {word: "traffic", meaning: "äº¤é€š", example: "There's heavy traffic on the highway.", level: "beginner"},
                    {word: "hospital", meaning: "ç—…é™¢", example: "I need to visit the hospital for a check-up.", level: "beginner"},
                    {word: "restaurant", meaning: "ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³", example: "Let's try that new restaurant.", level: "beginner"},
                    {word: "vacation", meaning: "ä¼‘æš‡", example: "I'm planning a vacation to Hawaii.", level: "beginner"},
                    {word: "exercise", meaning: "é‹å‹•", example: "I exercise three times a week.", level: "beginner"},
                    {word: "laundry", meaning: "æ´—æ¿¯", example: "I need to do the laundry today.", level: "beginner"},
                    {word: "shopping", meaning: "è²·ã„ç‰©", example: "I'm going shopping this afternoon.", level: "beginner"},
                    {word: "cooking", meaning: "æ–™ç†", example: "I enjoy cooking on weekends.", level: "beginner"},
                    {word: "cleaning", meaning: "æƒé™¤", example: "Saturday is my cleaning day.", level: "beginner"},
                    {word: "family", meaning: "å®¶æ—", example: "I'm spending time with my family tonight.", level: "beginner"},
                    {word: "friend", meaning: "å‹é”", example: "I'm meeting my friend for coffee.", level: "beginner"},
                    {word: "hobby", meaning: "è¶£å‘³", example: "Reading is my favorite hobby.", level: "beginner"},
                    {word: "movie", meaning: "æ˜ ç”»", example: "Let's watch a movie tonight.", level: "beginner"},
                    {word: "music", meaning: "éŸ³æ¥½", example: "I love listening to music while working.", level: "beginner"},
                    {word: "book", meaning: "æœ¬", example: "I'm reading an interesting book.", level: "beginner"}
                ],
                emotions: [
                    {word: "happy", meaning: "å¹¸ã›ãª", example: "I'm very happy with the results.", level: "beginner"},
                    {word: "sad", meaning: "æ‚²ã—ã„", example: "I felt sad when I heard the news.", level: "beginner"},
                    {word: "angry", meaning: "æ€’ã£ã¦ã„ã‚‹", example: "He was angry about the delay.", level: "beginner"},
                    {word: "excited", meaning: "èˆˆå¥®ã—ãŸ", example: "I'm excited about the new job.", level: "beginner"},
                    {word: "nervous", meaning: "ç·Šå¼µã—ãŸ", example: "I'm nervous about the presentation.", level: "beginner"},
                    {word: "tired", meaning: "ç–²ã‚ŒãŸ", example: "I'm tired after the long meeting.", level: "beginner"},
                    {word: "stressed", meaning: "ã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ„Ÿã˜ã‚‹", example: "I'm stressed about the deadline.", level: "beginner"},
                    {word: "worried", meaning: "å¿ƒé…ãª", example: "I'm worried about the test results.", level: "beginner"},
                    {word: "confused", meaning: "æ··ä¹±ã—ãŸ", example: "I'm confused about the instructions.", level: "beginner"},
                    {word: "surprised", meaning: "é©šã„ãŸ", example: "I was surprised by the news.", level: "beginner"},
                    {word: "disappointed", meaning: "ãŒã£ã‹ã‚Šã—ãŸ", example: "I'm disappointed with the outcome.", level: "beginner"},
                    {word: "proud", meaning: "èª‡ã‚‰ã—ã„", example: "I'm proud of my team's achievement.", level: "beginner"},
                    {word: "grateful", meaning: "æ„Ÿè¬ã—ã¦ã„ã‚‹", example: "I'm grateful for your help.", level: "beginner"},
                    {word: "curious", meaning: "å¥½å¥‡å¿ƒãŒã‚ã‚‹", example: "I'm curious about the new project.", level: "beginner"},
                    {word: "comfortable", meaning: "å¿«é©ãª", example: "I feel comfortable in this environment.", level: "beginner"},
                    {word: "uncomfortable", meaning: "ä¸å¿«ãª", example: "I feel uncomfortable in crowded places.", level: "beginner"},
                    {word: "relaxed", meaning: "ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ãŸ", example: "I feel relaxed after the vacation.", level: "beginner"},
                    {word: "confident", meaning: "è‡ªä¿¡ãŒã‚ã‚‹", example: "I'm confident about the presentation.", level: "beginner"},
                    {word: "motivated", meaning: "ã‚„ã‚‹æ°—ãŒã‚ã‚‹", example: "I'm motivated to learn English.", level: "beginner"},
                    {word: "satisfied", meaning: "æº€è¶³ã—ãŸ", example: "I'm satisfied with the progress.", level: "beginner"}
                ],
                trend: [
                    {word: "awesome", meaning: "ç´ æ™´ã‚‰ã—ã„", example: "That movie was totally awesome!", level: "beginner"},
                    {word: "cool", meaning: "ã‹ã£ã“ã„ã„", example: "Your new haircut looks really cool.", level: "beginner"},
                    {word: "amazing", meaning: "é©šãã¹ã", example: "The concert was amazing!", level: "beginner"},
                    {word: "fantastic", meaning: "ç´ æ™´ã‚‰ã—ã„", example: "You did a fantastic job!", level: "beginner"},
                    {word: "perfect", meaning: "å®Œç’§ãª", example: "The timing was perfect.", level: "beginner"},
                    {word: "brilliant", meaning: "ç´ æ™´ã‚‰ã—ã„", example: "That's a brilliant idea!", level: "beginner"},
                    {word: "incredible", meaning: "ä¿¡ã˜ã‚‰ã‚Œãªã„", example: "The view is incredible.", level: "beginner"},
                    {word: "outstanding", meaning: "å„ªç§€ãª", example: "Your performance was outstanding.", level: "beginner"},
                    {word: "excellent", meaning: "å„ªç§€ãª", example: "This is excellent work.", level: "beginner"},
                    {word: "wonderful", meaning: "ç´ æ™´ã‚‰ã—ã„", example: "We had a wonderful time.", level: "beginner"},
                    {word: "terrible", meaning: "ã²ã©ã„", example: "The weather was terrible.", level: "beginner"},
                    {word: "awful", meaning: "ã²ã©ã„", example: "That was an awful experience.", level: "beginner"},
                    {word: "boring", meaning: "é€€å±ˆãª", example: "The meeting was so boring.", level: "beginner"},
                    {word: "interesting", meaning: "é¢ç™½ã„", example: "That's a very interesting point.", level: "beginner"},
                    {word: "fun", meaning: "æ¥½ã—ã„", example: "The party was so much fun.", level: "beginner"},
                    {word: "crazy", meaning: "ã‚¯ãƒ¬ã‚¤ã‚¸ãƒ¼ãª", example: "That's a crazy idea!", level: "beginner"},
                    {word: "weird", meaning: "å¤‰ãª", example: "That's a weird coincidence.", level: "beginner"},
                    {word: "normal", meaning: "æ™®é€šã®", example: "That's perfectly normal.", level: "beginner"},
                    {word: "strange", meaning: "å¥‡å¦™ãª", example: "Something strange happened today.", level: "beginner"},
                    {word: "popular", meaning: "äººæ°—ã®", example: "This song is very popular.", level: "beginner"}
                ]
            },
            intermediate: {
                business: [
                    {word: "collaboration", meaning: "å”åŠ›", example: "The collaboration between departments was successful.", level: "intermediate"},
                    {word: "negotiation", meaning: "äº¤æ¸‰", example: "The contract negotiation took several weeks.", level: "intermediate"},
                    {word: "stakeholder", meaning: "åˆ©å®³é–¢ä¿‚è€…", example: "We need to consult all stakeholders.", level: "intermediate"},
                    {word: "implementation", meaning: "å®Ÿè£…", example: "The implementation phase starts next month.", level: "intermediate"},
                    {word: "evaluation", meaning: "è©•ä¾¡", example: "The project evaluation revealed some issues.", level: "intermediate"},
                    {word: "productivity", meaning: "ç”Ÿç”£æ€§", example: "We need to improve team productivity.", level: "intermediate"},
                    {word: "efficiency", meaning: "åŠ¹ç‡", example: "The new system increased efficiency by 30%.", level: "intermediate"},
                    {word: "strategy", meaning: "æˆ¦ç•¥", example: "Our marketing strategy needs revision.", level: "intermediate"},
                    {word: "objective", meaning: "ç›®æ¨™", example: "What's the main objective of this project?", level: "intermediate"},
                    {word: "achievement", meaning: "é”æˆ", example: "This is a significant achievement for our team.", level: "intermediate"},
                    {word: "opportunity", meaning: "æ©Ÿä¼š", example: "This presents a great opportunity for growth.", level: "intermediate"},
                    {word: "challenge", meaning: "èª²é¡Œ", example: "We're facing several challenges this quarter.", level: "intermediate"},
                    {word: "solution", meaning: "è§£æ±ºç­–", example: "We need to find a creative solution.", level: "intermediate"},
                    {word: "innovation", meaning: "é©æ–°", example: "Innovation is key to our success.", level: "intermediate"},
                    {word: "competitive", meaning: "ç«¶äº‰åŠ›ã®ã‚ã‚‹", example: "We need to stay competitive in the market.", level: "intermediate"},
                    {word: "sustainable", meaning: "æŒç¶šå¯èƒ½ãª", example: "We're committed to sustainable business practices.", level: "intermediate"},
                    {word: "expansion", meaning: "æ‹¡å¤§", example: "The company is planning international expansion.", level: "intermediate"},
                    {word: "investment", meaning: "æŠ•è³‡", example: "This requires a significant investment.", level: "intermediate"},
                    {word: "revenue", meaning: "åç›Š", example: "Our revenue increased by 15% this year.", level: "intermediate"},
                    {word: "performance", meaning: "ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹", example: "Your performance has been excellent.", level: "intermediate"}
                ],
                daily: [
                    {word: "commute", meaning: "é€šå‹¤", example: "My daily commute takes about an hour.", level: "intermediate"},
                    {word: "neighborhood", meaning: "è¿‘æ‰€", example: "I love living in this quiet neighborhood.", level: "intermediate"},
                    {word: "appliance", meaning: "å®¶é›»", example: "We need to buy new kitchen appliances.", level: "intermediate"},
                    {word: "maintenance", meaning: "ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹", example: "The building requires regular maintenance.", level: "intermediate"},
                    {word: "subscription", meaning: "ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³", example: "I have several streaming subscriptions.", level: "intermediate"},
                    {word: "convenience", meaning: "ä¾¿åˆ©ã•", example: "I appreciate the convenience of online shopping.", level: "intermediate"},
                    {word: "routine", meaning: "ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³", example: "I like to stick to my morning routine.", level: "intermediate"},
                    {word: "schedule", meaning: "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«", example: "My schedule is packed this week.", level: "intermediate"},
                    {word: "appointment", meaning: "äºˆç´„", example: "I have a dentist appointment tomorrow.", level: "intermediate"},
                    {word: "reservation", meaning: "äºˆç´„", example: "Did you make a reservation at the restaurant?", level: "intermediate"},
                    {word: "ingredient", meaning: "ææ–™", example: "I'm missing one ingredient for this recipe.", level: "intermediate"},
                    {word: "nutrition", meaning: "æ „é¤Š", example: "I'm trying to improve my nutrition.", level: "intermediate"},
                    {word: "exercise", meaning: "é‹å‹•", example: "Regular exercise is important for health.", level: "intermediate"},
                    {word: "recreation", meaning: "ãƒ¬ã‚¯ãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³", example: "The park provides good recreation facilities.", level: "intermediate"},
                    {word: "entertainment", meaning: "å¨¯æ¥½", example: "What do you do for entertainment?", level: "intermediate"},
                    {word: "relationship", meaning: "é–¢ä¿‚", example: "Building relationships takes time.", level: "intermediate"},
                    {word: "communication", meaning: "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³", example: "Good communication is essential.", level: "intermediate"},
                    {word: "experience", meaning: "çµŒé¨“", example: "That was an unforgettable experience.", level: "intermediate"},
                    {word: "opportunity", meaning: "æ©Ÿä¼š", example: "This is a great learning opportunity.", level: "intermediate"},
                    {word: "responsibility", meaning: "è²¬ä»»", example: "I take full responsibility for this mistake.", level: "intermediate"}
                ],
                emotions: [
                    {word: "overwhelmed", meaning: "åœ§å€’ã•ã‚ŒãŸ", example: "I feel overwhelmed by all these tasks.", level: "intermediate"},
                    {word: "frustrated", meaning: "ã‚¤ãƒ©ã‚¤ãƒ©ã—ãŸ", example: "I'm frustrated with the slow progress.", level: "intermediate"},
                    {word: "enthusiastic", meaning: "ç†±å¿ƒãª", example: "She's very enthusiastic about the project.", level: "intermediate"},
                    {word: "optimistic", meaning: "æ¥½è¦³çš„ãª", example: "I'm optimistic about our chances.", level: "intermediate"},
                    {word: "pessimistic", meaning: "æ‚²è¦³çš„ãª", example: "Don't be so pessimistic about the future.", level: "intermediate"},
                    {word: "anxious", meaning: "ä¸å®‰ãª", example: "I'm anxious about the interview.", level: "intermediate"},
                    {word: "relieved", meaning: "å®‰å¿ƒã—ãŸ", example: "I'm relieved that the project is finished.", level: "intermediate"},
                    {word: "determined", meaning: "æ±ºæ„ã—ãŸ", example: "I'm determined to succeed.", level: "intermediate"},
                    {word: "inspired", meaning: "ã‚¤ãƒ³ã‚¹ãƒ‘ã‚¤ã‚¢ã•ã‚ŒãŸ", example: "I feel inspired by her speech.", level: "intermediate"},
                    {word: "discouraged", meaning: "è½èƒ†ã—ãŸ", example: "Don't get discouraged by setbacks.", level: "intermediate"},
                    {word: "content", meaning: "æº€è¶³ã—ãŸ", example: "I'm content with my current situation.", level: "intermediate"},
                    {word: "ambitious", meaning: "é‡å¿ƒçš„ãª", example: "She's very ambitious about her career.", level: "intermediate"},
                    {word: "cautious", meaning: "æ…é‡ãª", example: "Be cautious when making decisions.", level: "intermediate"},
                    {word: "sympathetic", meaning: "åŒæƒ…çš„ãª", example: "I'm sympathetic to your situation.", level: "intermediate"},
                    {word: "empathetic", meaning: "å…±æ„Ÿçš„ãª", example: "She's very empathetic towards others.", level: "intermediate"},
                    {word: "skeptical", meaning: "æ‡ç–‘çš„ãª", example: "I'm skeptical about those claims.", level: "intermediate"},
                    {word: "impressed", meaning: "æ„ŸéŠ˜ã‚’å—ã‘ãŸ", example: "I'm impressed by your dedication.", level: "intermediate"},
                    {word: "astonished", meaning: "é©šæ„•ã—ãŸ", example: "I was astonished by the results.", level: "intermediate"},
                    {word: "delighted", meaning: "å¤§å–œã³ã—ãŸ", example: "I'm delighted with the outcome.", level: "intermediate"},
                    {word: "concerned", meaning: "å¿ƒé…ãª", example: "I'm concerned about the deadline.", level: "intermediate"}
                ],
                trend: [
                    {word: "viral", meaning: "ãƒã‚¤ãƒ©ãƒ«ãª", example: "That video went viral overnight.", level: "intermediate"},
                    {word: "trending", meaning: "ãƒˆãƒ¬ãƒ³ãƒ‰ã®", example: "This topic is trending on social media.", level: "intermediate"},
                    {word: "influencer", meaning: "ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚µãƒ¼", example: "She's a popular lifestyle influencer.", level: "intermediate"},
                    {word: "content", meaning: "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„", example: "They create amazing content.", level: "intermediate"},
                    {word: "algorithm", meaning: "ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ", example: "The algorithm determines what you see.", level: "intermediate"},
                    {word: "engagement", meaning: "ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆ", example: "Their posts get high engagement.", level: "intermediate"},
                    {word: "authentic", meaning: "æœ¬ç‰©ã®", example: "People prefer authentic content.", level: "intermediate"},
                    {word: "sustainable", meaning: "æŒç¶šå¯èƒ½ãª", example: "Sustainable fashion is becoming popular.", level: "intermediate"},
                    {word: "mindful", meaning: "æ³¨æ„æ·±ã„", example: "I'm trying to be more mindful of my choices.", level: "intermediate"},
                    {word: "wellness", meaning: "ã‚¦ã‚§ãƒ«ãƒã‚¹", example: "Wellness is a growing trend.", level: "intermediate"},
                    {word: "productivity", meaning: "ç”Ÿç”£æ€§", example: "I'm working on improving my productivity.", level: "intermediate"},
                    {word: "minimalism", meaning: "ãƒŸãƒ‹ãƒãƒªã‚ºãƒ ", example: "Minimalism helps reduce stress.", level: "intermediate"},
                    {word: "networking", meaning: "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°", example: "Networking is important for career growth.", level: "intermediate"},
                    {word: "mentorship", meaning: "ãƒ¡ãƒ³ã‚¿ãƒ¼ã‚·ãƒƒãƒ—", example: "I value mentorship in my career.", level: "intermediate"},
                    {word: "innovation", meaning: "é©æ–°", example: "Innovation drives business success.", level: "intermediate"},
                    {word: "disruption", meaning: "ç ´å£Šçš„å¤‰åŒ–", example: "Technology is causing market disruption.", level: "intermediate"},
                    {word: "collaboration", meaning: "å”åŠ›", example: "Remote collaboration tools are essential.", level: "intermediate"},
                    {word: "flexibility", meaning: "æŸ”è»Ÿæ€§", example: "Workplace flexibility is highly valued.", level: "intermediate"},
                    {word: "diversity", meaning: "å¤šæ§˜æ€§", example: "Diversity brings different perspectives.", level: "intermediate"},
                    {word: "inclusion", meaning: "åŒ…æ‹¬", example: "Inclusion is important in the workplace.", level: "intermediate"}
                ]
            },
            advanced: {
                business: [
                    {word: "procurement", meaning: "èª¿é”", example: "The procurement process needs streamlining.", level: "advanced"},
                    {word: "synergy", meaning: "ç›¸ä¹—åŠ¹æœ", example: "The merger created valuable synergies.", level: "advanced"},
                    {word: "paradigm", meaning: "ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ", example: "We need a paradigm shift in our approach.", level: "advanced"},
                    {word: "leverage", meaning: "æ´»ç”¨ã™ã‚‹", example: "We should leverage our existing assets.", level: "advanced"},
                    {word: "scalability", meaning: "æ‹¡å¼µæ€§", example: "The system's scalability is impressive.", level: "advanced"},
                    {word: "consolidation", meaning: "çµ±åˆ", example: "Market consolidation is inevitable.", level: "advanced"},
                    {word: "diversification", meaning: "å¤šæ§˜åŒ–", example: "Diversification reduces business risk.", level: "advanced"},
                    {word: "optimization", meaning: "æœ€é©åŒ–", example: "Process optimization saved significant costs.", level: "advanced"},
                    {word: "analytics", meaning: "åˆ†æå­¦", example: "Data analytics drives our decisions.", level: "advanced"},
                    {word: "compliance", meaning: "ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹", example: "Regulatory compliance is mandatory.", level: "advanced"},
                    {word: "governance", meaning: "ã‚¬ãƒãƒŠãƒ³ã‚¹", example: "Corporate governance ensures accountability.", level: "advanced"},
                    {word: "sustainability", meaning: "æŒç¶šå¯èƒ½æ€§", example: "Sustainability is core to our strategy.", level: "advanced"},
                    {word: "resilience", meaning: "å›å¾©åŠ›", example: "Business resilience is crucial for survival.", level: "advanced"},
                    {word: "agility", meaning: "æ©Ÿæ•æ€§", example: "Market agility gives us competitive advantage.", level: "advanced"},
                    {word: "innovation", meaning: "é©æ–°", example: "Continuous innovation drives growth.", level: "advanced"},
                    {word: "transformation", meaning: "å¤‰é©", example: "Digital transformation is reshaping industries.", level: "advanced"},
                    {word: "disruption", meaning: "ç ´å£Šçš„å¤‰åŒ–", example: "Technological disruption affects all sectors.", level: "advanced"},
                    {word: "ecosystem", meaning: "ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ", example: "We're building a business ecosystem.", level: "advanced"},
                    {word: "methodology", meaning: "æ–¹æ³•è«–", example: "Our methodology ensures consistent results.", level: "advanced"},
                    {word: "benchmarking", meaning: "ãƒ™ãƒ³ãƒãƒãƒ¼ã‚­ãƒ³ã‚°", example: "Benchmarking helps identify best practices.", level: "advanced"}
                ],
                daily: [
                    {word: "serendipity", meaning: "å¶ç„¶ã®ç™ºè¦‹", example: "Meeting you here was pure serendipity.", level: "advanced"},
                    {word: "contemplation", meaning: "ç†Ÿè€ƒ", example: "The garden is perfect for quiet contemplation.", level: "advanced"},
                    {word: "perseverance", meaning: "å¿è€", example: "Success requires dedication and perseverance.", level: "advanced"},
                    {word: "spontaneity", meaning: "è‡ªç™ºæ€§", example: "I love the spontaneity of weekend adventures.", level: "advanced"},
                    {word: "resilience", meaning: "å›å¾©åŠ›", example: "She showed remarkable resilience after the setback.", level: "advanced"},
                    {word: "introspection", meaning: "å†…çœ", example: "Travel often leads to deep introspection.", level: "advanced"},
                    {word: "mindfulness", meaning: "ãƒã‚¤ãƒ³ãƒ‰ãƒ•ãƒ«ãƒã‚¹", example: "Mindfulness meditation helps reduce stress.", level: "advanced"},
                    {word: "authenticity", meaning: "çœŸæ­£æ€§", example: "People appreciate authenticity in relationships.", level: "advanced"},
                    {word: "vulnerability", meaning: "è„†å¼±æ€§", example: "Showing vulnerability requires courage.", level: "advanced"},
                    {word: "empathy", meaning: "å…±æ„Ÿ", example: "Empathy is essential for understanding others.", level: "advanced"},
                    {word: "gratitude", meaning: "æ„Ÿè¬", example: "Expressing gratitude improves well-being.", level: "advanced"},
                    {word: "contentment", meaning: "æº€è¶³", example: "True contentment comes from within.", level: "advanced"},
                    {word: "fulfillment", meaning: "å……å®Ÿ", example: "I find fulfillment in helping others.", level: "advanced"},
                    {word: "enlightenment", meaning: "å•“ç™º", example: "The book provided spiritual enlightenment.", level: "advanced"},
                    {word: "sophistication", meaning: "æ´—ç·´", example: "The restaurant has an air of sophistication.", level: "advanced"},
                    {word: "elegance", meaning: "å„ªé›…ã•", example: "She moved with natural elegance.", level: "advanced"},
                    {word: "charisma", meaning: "ã‚«ãƒªã‚¹ãƒ", example: "His charisma makes him a natural leader.", level: "advanced"},
                    {word: "diplomacy", meaning: "å¤–äº¤è¡“", example: "The situation requires careful diplomacy.", level: "advanced"},
                    {word: "discernment", meaning: "æ´å¯ŸåŠ›", example: "Good judgment requires discernment.", level: "advanced"},
                    {word: "eloquence", meaning: "é›„å¼", example: "Her eloquence captivated the audience.", level: "advanced"}
                ],
                emotions: [
                    {word: "euphoric", meaning: "é™¶é…”çš„ãª", example: "I felt euphoric after achieving my goal.", level: "advanced"},
                    {word: "melancholic", meaning: "æ†‚é¬±ãª", example: "The rainy weather makes me feel melancholic.", level: "advanced"},
                    {word: "nostalgic", meaning: "æ‡ã‹ã—ã„", example: "Old photos make me feel nostalgic.", level: "advanced"},
                    {word: "apprehensive", meaning: "ä¸å®‰ãª", example: "I'm apprehensive about the changes ahead.", level: "advanced"},
                    {word: "exhilarated", meaning: "çˆ½å¿«ãª", example: "The mountain view left me exhilarated.", level: "advanced"},
                    {word: "contemplative", meaning: "ç‘æƒ³çš„ãª", example: "I'm in a contemplative mood today.", level: "advanced"},
                    {word: "vindicated", meaning: "æ­£å½“åŒ–ã•ã‚ŒãŸ", example: "I felt vindicated when the truth came out.", level: "advanced"},
                    {word: "rejuvenated", meaning: "è‹¥è¿”ã£ãŸ", example: "The vacation left me feeling rejuvenated.", level: "advanced"},
                    {word: "invigorated", meaning: "æ´»åŠ›ã‚’å¾—ãŸ", example: "The morning run left me invigorated.", level: "advanced"},
                    {word: "serene", meaning: "ç©ã‚„ã‹ãª", example: "The lake view made me feel serene.", level: "advanced"},
                    {word: "tranquil", meaning: "é™ã‹ãª", example: "I prefer tranquil environments for work.", level: "advanced"},
                    {word: "bewildered", meaning: "å½“æƒ‘ã—ãŸ", example: "I was bewildered by the complex instructions.", level: "advanced"},
                    {word: "perplexed", meaning: "å›°æƒ‘ã—ãŸ", example: "The puzzle left me completely perplexed.", level: "advanced"},
                    {word: "jubilant", meaning: "æ­“å–œã®", example: "The team was jubilant after winning.", level: "advanced"},
                    {word: "ecstatic", meaning: "ææƒšã¨ã—ãŸ", example: "She was ecstatic about the promotion.", level: "advanced"},
                    {word: "despondent", meaning: "è½èƒ†ã—ãŸ", example: "He became despondent after the rejection.", level: "advanced"},
                    {word: "indignant", meaning: "æ†¤æ…¨ã—ãŸ", example: "I was indignant at the unfair treatment.", level: "advanced"},
                    {word: "reverent", meaning: "æ•¬è™”ãª", example: "They maintained a reverent silence.", level: "advanced"},
                    {word: "whimsical", meaning: "æ°—ã¾ãã‚Œãª", example: "Her whimsical nature is endearing.", level: "advanced"},
                    {word: "poignant", meaning: "å¿ƒã‚’æ‰“ã¤", example: "The farewell was particularly poignant.", level: "advanced"}
                ],
                trend: [
                    {word: "cryptocurrency", meaning: "æš—å·é€šè²¨", example: "Cryptocurrency is revolutionizing finance.", level: "advanced"},
                    {word: "blockchain", meaning: "ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³", example: "Blockchain technology ensures transparency.", level: "advanced"},
                    {word: "metaverse", meaning: "ãƒ¡ã‚¿ãƒãƒ¼ã‚¹", example: "The metaverse is the future of interaction.", level: "advanced"},
                    {word: "sustainability", meaning: "æŒç¶šå¯èƒ½æ€§", example: "Sustainability is driving consumer choices.", level: "advanced"},
                    {word: "automation", meaning: "è‡ªå‹•åŒ–", example: "Automation is transforming industries.", level: "advanced"},
                    {word: "personalization", meaning: "å€‹äººåŒ–", example: "AI enables mass personalization.", level: "advanced"},
                    {word: "digitization", meaning: "ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–", example: "Digitization is accelerating business processes.", level: "advanced"},
                    {word: "decentralization", meaning: "åˆ†æ•£åŒ–", example: "Decentralization reduces system risks.", level: "advanced"},
                    {word: "gamification", meaning: "ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³", example: "Gamification increases user engagement.", level: "advanced"},
                    {word: "optimization", meaning: "æœ€é©åŒ–", example: "SEO optimization improves website visibility.", level: "advanced"},
                    {word: "monetization", meaning: "åç›ŠåŒ–", example: "Content monetization strategies vary widely.", level: "advanced"},
                    {word: "scalability", meaning: "æ‹¡å¼µæ€§", example: "Cloud solutions offer excellent scalability.", level: "advanced"},
                    {word: "interoperability", meaning: "ç›¸äº’é‹ç”¨æ€§", example: "Interoperability between systems is crucial.", level: "advanced"},
                    {word: "tokenization", meaning: "ãƒˆãƒ¼ã‚¯ãƒ³åŒ–", example: "Asset tokenization opens new opportunities.", level: "advanced"},
                    {word: "democratization", meaning: "æ°‘ä¸»åŒ–", example: "Technology democratizes access to information.", level: "advanced"},
                    {word: "hybridization", meaning: "ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰åŒ–", example: "Hybridization of work models is common.", level: "advanced"},
                    {word: "miniaturization", meaning: "å°å‹åŒ–", example: "Miniaturization makes devices more portable.", level: "advanced"},
                    {word: "virtualization", meaning: "ä»®æƒ³åŒ–", example: "Virtualization reduces hardware costs.", level: "advanced"},
                    {word: "synchronization", meaning: "åŒæœŸåŒ–", example: "Data synchronization prevents conflicts.", level: "advanced"},
                    {word: "differentiation", meaning: "å·®åˆ¥åŒ–", example: "Brand differentiation is increasingly difficult.", level: "advanced"}
                ]
            }
        };

        let phrases = {
            daily: [
                {phrase: "I'm totally beat!", meaning: "ã‚ã£ã¡ã‚ƒç–²ã‚ŒãŸï¼", usage: "â˜…â˜…â˜…â˜…â˜…", context: "After a long day"},
                {phrase: "No worries!", meaning: "æ°—ã«ã—ãªã„ã§ï¼", usage: "â˜…â˜…â˜…â˜…â˜…", context: "Casual response"},
                {phrase: "I'm down for that", meaning: "ãã‚Œã„ã„ã­ï¼", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Agreeing to plans"},
                {phrase: "That's fire!", meaning: "ã‚ã£ã¡ã‚ƒã„ã„ï¼", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Really liking something"},
                {phrase: "I'm good", meaning: "å¤§ä¸ˆå¤«ã ã‚ˆ", usage: "â˜…â˜…â˜…â˜…â˜…", context: "Polite decline"},
                {phrase: "That's a no-brainer", meaning: "ãã‚Œã¯å½“ç„¶ã ã­", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Easy decision"},
                {phrase: "I'm all ears", meaning: "è©³ã—ãèã‹ã›ã¦", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Ready to listen"},
                {phrase: "Piece of cake", meaning: "ç°¡å˜ã ã‚ˆ", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Something easy"},
                {phrase: "Break a leg!", meaning: "é ‘å¼µã£ã¦ï¼", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Good luck wishes"},
                {phrase: "It's raining cats and dogs", meaning: "åœŸç ‚é™ã‚Šã ", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Heavy rain"},
                {phrase: "Time flies", meaning: "æ™‚é–“ãŒéãã‚‹ã®ã¯æ—©ã„", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Time passing quickly"},
                {phrase: "Better late than never", meaning: "é…ãã¦ã‚‚æ¥ãªã„ã‚ˆã‚Šã¾ã—", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Arriving late"},
                {phrase: "Kill two birds with one stone", meaning: "ä¸€çŸ³äºŒé³¥", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Efficient action"},
                {phrase: "The ball is in your court", meaning: "ã‚ãªãŸæ¬¡ç¬¬ã§ã™", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Decision time"},
                {phrase: "Don't count your chickens before they hatch", meaning: "å–ã‚‰ã¬ç‹¸ã®çš®ç®—ç”¨", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Don't assume success"},
                {phrase: "A picture is worth a thousand words", meaning: "ç™¾èã¯ä¸€è¦‹ã«ã—ã‹ãš", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Visual explanation"},
                {phrase: "When pigs fly", meaning: "ã‚ã‚Šå¾—ãªã„", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Something impossible"},
                {phrase: "The early bird catches the worm", meaning: "æ—©èµ·ãã¯ä¸‰æ–‡ã®å¾³", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Being early"},
                {phrase: "Don't put all your eggs in one basket", meaning: "ãƒªã‚¹ã‚¯ã‚’åˆ†æ•£ã—ã‚", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Risk management"},
                {phrase: "Actions speak louder than words", meaning: "è¡Œå‹•ã¯è¨€è‘‰ã‚ˆã‚Šé›„å¼", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Doing vs saying"}
            ],
            business: [
                {phrase: "Let's circle back on this", meaning: "ã“ã‚Œã¯å¾Œã§å†æ¤œè¨ã—ã¾ã—ã‚‡ã†", usage: "â˜…â˜…â˜…â˜…â˜…", context: "Meeting discussions"},
                {phrase: "I'll ping you later", meaning: "å¾Œã§é€£çµ¡ã—ã¾ã™", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Follow-up promise"},
                {phrase: "We're on the same page", meaning: "èªè­˜ãŒä¸€è‡´ã—ã¦ã„ã¾ã™ã­", usage: "â˜…â˜…â˜…â˜…â˜…", context: "Agreement confirmation"},
                {phrase: "Let's touch base", meaning: "é€£çµ¡ã‚’å–ã‚Šåˆã„ã¾ã—ã‚‡ã†", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Planning communication"},
                {phrase: "I'll loop you in", meaning: "ã‚ãªãŸã‚‚å‚åŠ ã•ã›ã¾ã™", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Including someone"},
                {phrase: "We're in the same boat", meaning: "åŒã˜çŠ¶æ³ã§ã™ã­", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Shared challenges"},
                {phrase: "Let's think outside the box", meaning: "å‹ã«ã¯ã¾ã‚‰ãªã„ç™ºæƒ³ã‚’ã—ã¾ã—ã‚‡ã†", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Creative thinking"},
                {phrase: "That's a game changer", meaning: "ãã‚Œã¯é©å‘½çš„ã§ã™ã­", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Significant impact"},
                {phrase: "Let's run it up the flagpole", meaning: "ä¸Šå¸ã«ç›¸è«‡ã—ã¦ã¿ã¾ã—ã‚‡ã†", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Seeking approval"},
                {phrase: "We need to move the needle", meaning: "æˆæœã‚’å‡ºã™å¿…è¦ãŒã‚ã‚‹", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Making progress"},
                {phrase: "Let's table this for now", meaning: "ã“ã‚Œã¯ä¸€æ—¦ä¿ç•™ã«ã—ã¾ã—ã‚‡ã†", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Postponing discussion"},
                {phrase: "We're behind the eight ball", meaning: "å›°é›£ãªçŠ¶æ³ã§ã™", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Challenging situation"},
                {phrase: "Let's get the ball rolling", meaning: "å§‹ã‚ã¾ã—ã‚‡ã†", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Starting initiative"},
                {phrase: "That's low-hanging fruit", meaning: "ãã‚Œã¯ç°¡å˜ã«é”æˆã§ãã‚‹", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Easy wins"},
                {phrase: "We need to pivot", meaning: "æ–¹å‘è»¢æ›ãŒå¿…è¦ã§ã™", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Strategy change"},
                {phrase: "Let's drill down", meaning: "è©³ã—ãèª¿ã¹ã¾ã—ã‚‡ã†", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Deep analysis"},
                {phrase: "We need buy-in", meaning: "åˆæ„ãŒå¿…è¦ã§ã™", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Getting support"},
                {phrase: "That's a stretch goal", meaning: "ãã‚Œã¯é«˜ã„ç›®æ¨™ã§ã™ã­", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Ambitious targets"},
                {phrase: "Let's align on expectations", meaning: "æœŸå¾…å€¤ã‚’åˆã‚ã›ã¾ã—ã‚‡ã†", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Setting clear goals"},
                {phrase: "We need to scale up", meaning: "è¦æ¨¡ã‚’æ‹¡å¤§ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Growth plans"}
            ],
            slang: [
                {phrase: "That slaps!", meaning: "ãã‚Œã‚ã£ã¡ã‚ƒã„ã„ï¼", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Young people's enthusiasm"},
                {phrase: "No cap", meaning: "ãƒã‚¸ã§", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Being serious"},
                {phrase: "It's giving...", meaning: "ã€œãªæ„Ÿã˜", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Describing vibes"},
                {phrase: "That's sus", meaning: "ãã‚Œæ€ªã—ã„", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Something suspicious"},
                {phrase: "I'm living for this", meaning: "ã“ã‚Œæœ€é«˜ï¼", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Really enjoying"},
                {phrase: "Periodt", meaning: "ä»¥ä¸Šï¼", usage: "â˜…â˜…â˜†â˜†â˜†", context: "End of discussion"},
                {phrase: "It hits different", meaning: "æ ¼åˆ¥ã ã­", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Special experience"},
                {phrase: "That's bussin", meaning: "ã‚ã£ã¡ã‚ƒã†ã¾ã„", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Great food"},
                {phrase: "I can't even", meaning: "ã‚‚ã†ç„¡ç†", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Overwhelming feeling"},
                {phrase: "It's a whole mood", meaning: "ã™ã”ãå…±æ„Ÿ", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Relating to something"},
                {phrase: "That's a vibe", meaning: "ã„ã„æ„Ÿã˜", usage: "â˜…â˜…â˜…â˜…â˜†", context: "Good atmosphere"},
                {phrase: "I'm deceased", meaning: "çˆ†ç¬‘", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Very funny"},
                {phrase: "Spill the tea", meaning: "ã‚´ã‚·ãƒƒãƒ—æ•™ãˆã¦", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Want gossip"},
                {phrase: "That's a flex", meaning: "è‡ªæ…¢ã ã­", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Showing off"},
                {phrase: "I'm shook", meaning: "ã‚·ãƒ§ãƒƒã‚¯", usage: "â˜…â˜…â˜…â˜†â˜†", context: "Surprised reaction"},
                {phrase: "It's giving main character energy", meaning: "ä¸»äººå…¬ã‚ªãƒ¼ãƒ©", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Confident attitude"},
                {phrase: "That's rent-free in my head", meaning: "é ­ã‹ã‚‰é›¢ã‚Œãªã„", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Can't stop thinking"},
                {phrase: "Touch grass", meaning: "å¤–ã«å‡ºã‚", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Go outside more"},
                {phrase: "It's giving vintage", meaning: "ãƒ¬ãƒˆãƒ­ãªæ„Ÿã˜", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Old-style vibe"},
                {phrase: "That's lowkey fire", meaning: "å®Ÿã¯ã„ã„ã‚ˆã­", usage: "â˜…â˜…â˜†â˜†â˜†", context: "Subtle appreciation"}
            ]
        };

        // Level diagnosis questions
        let diagnosisQuestions = [
            {
                question: "Choose the best translation for 'I appreciate your help':",
                options: ["ã‚ãªãŸã®åŠ©ã‘ã«æ„Ÿè¬ã—ã¾ã™", "ã‚ãªãŸã¯è¦ªåˆ‡ã§ã™", "åŠ©ã‘ã¦ãã ã•ã„", "ã‚ã‚ŠãŒã¨ã†"],
                correct: 0,
                level: "basic"
            },
            {
                question: "What does 'Let's touch base next week' mean?",
                options: ["æ¥é€±ä¼šã„ã¾ã—ã‚‡ã†", "æ¥é€±é€£çµ¡ã‚’å–ã‚Šã¾ã—ã‚‡ã†", "æ¥é€±ä»•äº‹ã—ã¾ã—ã‚‡ã†", "æ¥é€±ä¼‘ã¿ã¾ã—ã‚‡ã†"],
                correct: 1,
                level: "intermediate"
            },
            {
                question: "Choose the most natural response to 'How's it going?':",
                options: ["I am fine thank you", "Not bad, you?", "Yes, I am good", "I go well"],
                correct: 1,
                level: "intermediate"
            },
            {
                question: "What's the meaning of 'We need to pivot our strategy'?",
                options: ["æˆ¦ç•¥ã‚’ç¶™ç¶šã™ã‚‹", "æˆ¦ç•¥ã‚’æ–¹å‘è»¢æ›ã™ã‚‹", "æˆ¦ç•¥ã‚’ä¸­æ­¢ã™ã‚‹", "æˆ¦ç•¥ã‚’ç™ºè¡¨ã™ã‚‹"],
                correct: 1,
                level: "advanced"
            },
            {
                question: "Which sentence shows the most advanced English?",
                options: [
                    "The meeting was good",
                    "The meeting was productive and yielded actionable insights",
                    "The meeting was very nice",
                    "We had a meeting"
                ],
                correct: 1,
                level: "advanced"
            }
        ];

        // Learning state
        let currentLevel = localStorage.getItem('userLevel') || 'undiagnosed';
        let todayWords = parseInt(localStorage.getItem('todayWords')) || 0;
        let studyStreak = parseInt(localStorage.getItem('studyStreak')) || 0;
        let totalWords = parseInt(localStorage.getItem('totalWords')) || 0;
        let totalPhrases = parseInt(localStorage.getItem('totalPhrases')) || 0;
        let totalTests = parseInt(localStorage.getItem('totalTests')) || 0;
        let testScores = JSON.parse(localStorage.getItem('testScores')) || [];
        let usedWords = JSON.parse(localStorage.getItem('usedWords')) || [];
        let usedPhrases = JSON.parse(localStorage.getItem('usedPhrases')) || [];

        // Character guide messages
        let emiMessages = [
            "æ–°ã—ã„å˜èªã‚’è¦šãˆãŸã­ï¼ç´ æ™´ã‚‰ã—ã„âœ¨",
            "ã“ã®èª¿å­ã§é ‘å¼µã£ã¦ï¼",
            "ç™ºéŸ³ã‚‚ä¸€ç·’ã«ç·´ç¿’ã—ã¦ã¿ã‚ˆã†ğŸµ",
            "æ¯æ—¥å°‘ã—ãšã¤ã§ã‚‚ç¶™ç¶šãŒå¤§åˆ‡ã ã‚ˆï¼",
            "ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ•ãƒ¬ãƒ¼ã‚ºã‚‚è¦šãˆã¦ã¿ã‚ˆã†ï¼",
            "ãƒ†ã‚¹ãƒˆã§å®ŸåŠ›ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ğŸ“",
            "ä»Šæ—¥ã‚‚è‹±èªå­¦ç¿’ãŠç–²ã‚Œã•ã¾ï¼",
            "å¾©ç¿’ã‚‚å¿˜ã‚Œãšã«ã­ğŸ’ª",
            "è‹±èªå­¦ç¿’ã‚’æ¥½ã—ã‚“ã§ã‚‹ï¼ŸğŸ˜Š",
            "æ–°ã—ã„ãƒ•ãƒ¬ãƒ¼ã‚ºã§è¡¨ç¾åŠ›ã‚¢ãƒƒãƒ—ï¼"
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateUI();
            initializeEmi();
            setInterval(randomEmiMessage, 30000); // Every 30 seconds
        });

        function updateUI() {
            document.getElementById('currentLevel').textContent = currentLevel === 'undiagnosed' ? 'æœªè¨ºæ–­' : 
                currentLevel === 'beginner' ? 'åˆç´š' : 
                currentLevel === 'intermediate' ? 'ä¸­ç´š' : 'ä¸Šç´š';
            
            let progress = currentLevel === 'beginner' ? 33 : currentLevel === 'intermediate' ? 66 : 
                          currentLevel === 'advanced' ? 100 : 0;
            document.getElementById('levelProgressBar').style.width = progress + '%';
            
            document.getElementById('todayWords').textContent = todayWords;
            document.getElementById('studyStreak').textContent = studyStreak;
            document.getElementById('totalWords').textContent = totalWords;
            document.getElementById('totalPhrases').textContent = totalPhrases;
            document.getElementById('totalTests').textContent = totalTests;
            
            let avgScore = testScores.length > 0 ? 
                Math.round(testScores.reduce((a, b) => a + b, 0) / testScores.length) : 0;
            document.getElementById('testScore').textContent = avgScore + '%';
        }

        function initializeEmi() {
            document.getElementById('emiCharacter').addEventListener('click', function() {
                let speech = document.getElementById('emiSpeech');
                speech.style.display = speech.style.display === 'none' ? 'block' : 'none';
            });
        }

        function randomEmiMessage() {
            let message = emiMessages[Math.floor(Math.random() * emiMessages.length)];
            document.getElementById('emiMessage').innerHTML = message;
            
            // Show speech bubble briefly
            let speech = document.getElementById('emiSpeech');
            speech.style.display = 'block';
            setTimeout(() => {
                speech.style.display = 'none';
            }, 3000);
        }

        function startLevelDiagnosis() {
            document.getElementById('diagnosisStart').style.display = 'none';
            document.getElementById('diagnosisQuestions').style.display = 'block';
            
            let questionsHtml = '<div class="space-y-6">';
            diagnosisQuestions.forEach((q, index) => {
                questionsHtml += `
                    <div class="question-card p-4 rounded-lg">
                        <h4 class="font-semibold mb-3">å•é¡Œ ${index + 1}: ${q.question}</h4>
                        <div class="space-y-2">
                `;
                q.options.forEach((option, optIndex) => {
                    questionsHtml += `
                        <label class="flex items-center space-x-2 cursor-pointer hover:bg-gray-100 p-2 rounded">
                            <input type="radio" name="q${index}" value="${optIndex}" class="text-blue-500">
                            <span>${option}</span>
                        </label>
                    `;
                });
                questionsHtml += '</div></div>';
            });
            questionsHtml += `
                <div class="text-center">
                    <button onclick="submitDiagnosis()" class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-lg font-medium">
                        <i class="fas fa-check mr-2"></i>è¨ºæ–­çµæœã‚’è¦‹ã‚‹
                    </button>
                </div>
            </div>`;
            
            document.getElementById('diagnosisQuestions').innerHTML = questionsHtml;
        }

        function submitDiagnosis() {
            let correctAnswers = 0;
            let totalQuestions = diagnosisQuestions.length;
            
            diagnosisQuestions.forEach((q, index) => {
                let selected = document.querySelector(`input[name="q${index}"]:checked`);
                if (selected && parseInt(selected.value) === q.correct) {
                    correctAnswers++;
                }
            });
            
            let percentage = (correctAnswers / totalQuestions) * 100;
            let level = percentage >= 80 ? 'advanced' : percentage >= 60 ? 'intermediate' : 'beginner';
            
            currentLevel = level;
            localStorage.setItem('userLevel', level);
            
            showDiagnosisResult(correctAnswers, totalQuestions, level);
            updateUI();
        }

        function showDiagnosisResult(correct, total, level) {
            let levelText = level === 'beginner' ? 'åˆç´š' : level === 'intermediate' ? 'ä¸­ç´š' : 'ä¸Šç´š';
            let levelColor = level === 'beginner' ? 'text-green-600' : level === 'intermediate' ? 'text-yellow-600' : 'text-red-600';
            
            let resultHtml = `
                <div class="text-center">
                    <div class="text-6xl mb-4">ğŸ‰</div>
                    <h3 class="text-2xl font-bold mb-4">è¨ºæ–­å®Œäº†ï¼</h3>
                    <div class="text-lg mb-4">
                        æ­£è§£æ•°: <span class="font-bold">${correct}/${total}</span>
                    </div>
                    <div class="text-xl mb-6">
                        ã‚ãªãŸã®ãƒ¬ãƒ™ãƒ«: <span class="font-bold ${levelColor}">${levelText}</span>
                    </div>
                    <p class="text-gray-600 mb-6">
                        ã“ã‚Œã‹ã‚‰ã‚ãªãŸã®ãƒ¬ãƒ™ãƒ«ã«åˆã‚ã›ãŸå­¦ç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æä¾›ã—ã¾ã™ï¼
                    </p>
                    <button onclick="closeDiagnosis()" class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-lg font-medium">
                        <i class="fas fa-arrow-right mr-2"></i>å­¦ç¿’ã‚’é–‹å§‹
                    </button>
                </div>
            `;
            
            document.getElementById('diagnosisQuestions').style.display = 'none';
            document.getElementById('diagnosisResult').style.display = 'block';
            document.getElementById('diagnosisResult').innerHTML = resultHtml;
            
            // Show Emi message
            document.getElementById('emiMessage').innerHTML = `è¨ºæ–­ãŠç–²ã‚Œã•ã¾ï¼<br>${levelText}ãƒ¬ãƒ™ãƒ«ã§ã™ã­âœ¨<br>ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼`;
            document.getElementById('emiSpeech').style.display = 'block';
        }

        function closeDiagnosis() {
            document.getElementById('levelDiagnosisSection').style.display = 'none';
        }

        function getNewWord() {
            let level = document.getElementById('vocabularyLevel').value;
            let category = document.getElementById('vocabularyCategory').value;
            let words = vocabulary[level][category];
            
            // Anti-repetition logic: ensure 10 words gap
            let availableWords = words.filter(word => {
                let lastIndex = usedWords.findIndex(used => used.word === word.word);
                return lastIndex === -1 || usedWords.length - lastIndex > 10;
            });
            
            if (availableWords.length === 0) {
                availableWords = words; // Reset if all words used recently
                usedWords = [];
            }
            
            let word = availableWords[Math.floor(Math.random() * availableWords.length)];
            
            // Update used words list
            usedWords.push(word);
            if (usedWords.length > 50) usedWords.shift(); // Keep only last 50
            localStorage.setItem('usedWords', JSON.stringify(usedWords));
            
            // Update statistics
            todayWords++;
            totalWords++;
            localStorage.setItem('todayWords', todayWords);
            localStorage.setItem('totalWords', totalWords);
            
            let content = `
                <div class="text-center">
                    <div class="text-4xl mb-4">ğŸ“</div>
                    <h3 class="text-2xl font-bold text-blue-600 mb-2">${word.word}</h3>
                    <p class="text-lg text-gray-600 mb-4">${word.meaning}</p>
                    <div class="bg-gray-100 p-4 rounded-lg mb-4">
                        <p class="text-sm text-gray-700 italic">"${word.example}"</p>
                    </div>
                    <div class="flex justify-center space-x-2">
                        <span class="bg-${word.level === 'beginner' ? 'green' : word.level === 'intermediate' ? 'yellow' : 'red'}-100 text-${word.level === 'beginner' ? 'green' : word.level === 'intermediate' ? 'yellow' : 'red'}-800 px-3 py-1 rounded-full text-sm">
                            ${word.level.toUpperCase()}
                        </span>
                        <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
                            ${category.toUpperCase()}
                        </span>
                    </div>
                    <button onclick="speakWord('${word.word}')" class="mt-4 bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg">
                        <i class="fas fa-volume-up mr-2"></i>ç™ºéŸ³ã‚’èã
                    </button>
                </div>
            `;
            
            document.getElementById('vocabularyContent').innerHTML = content;
            updateUI();
            
            // Show Emi encouragement
            setTimeout(() => {
                document.getElementById('emiMessage').innerHTML = `æ–°ã—ã„å˜èªã€Œ${word.word}ã€ã‚’è¦šãˆãŸã­ï¼<br>ç´ æ™´ã‚‰ã—ã„é€²æ­©ã ã‚ˆâœ¨`;
                document.getElementById('emiSpeech').style.display = 'block';
                setTimeout(() => document.getElementById('emiSpeech').style.display = 'none', 3000);
            }, 1000);
        }

        function getNewPhrase() {
            let category = document.getElementById('phraseCategory').value;
            let phrasesArray = phrases[category];
            
            // Anti-repetition logic for phrases
            let availablePhrases = phrasesArray.filter(phrase => {
                let lastIndex = usedPhrases.findIndex(used => used.phrase === phrase.phrase);
                return lastIndex === -1 || usedPhrases.length - lastIndex > 10;
            });
            
            if (availablePhrases.length === 0) {
                availablePhrases = phrasesArray;
                usedPhrases = [];
            }
            
            let phrase = availablePhrases[Math.floor(Math.random() * availablePhrases.length)];
            
            // Update used phrases list
            usedPhrases.push(phrase);
            if (usedPhrases.length > 50) usedPhrases.shift();
            localStorage.setItem('usedPhrases', JSON.stringify(usedPhrases));
            
            // Update statistics
            totalPhrases++;
            localStorage.setItem('totalPhrases', totalPhrases);
            
            let content = `
                <div class="text-center">
                    <div class="text-4xl mb-4">ğŸ’¬</div>
                    <h3 class="text-xl font-bold text-purple-600 mb-2">"${phrase.phrase}"</h3>
                    <p class="text-lg text-gray-600 mb-4">${phrase.meaning}</p>
                    <div class="bg-gray-100 p-4 rounded-lg mb-4">
                        <p class="text-sm text-gray-700"><strong>ä½¿ç”¨é »åº¦:</strong> ${phrase.usage}</p>
                        <p class="text-sm text-gray-700 mt-2"><strong>ä½¿ç”¨å ´é¢:</strong> ${phrase.context}</p>
                    </div>
                    <div class="flex justify-center space-x-2">
                        <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">
                            ${category.toUpperCase()}
                        </span>
                    </div>
                    <button onclick="speakPhrase('${phrase.phrase}')" class="mt-4 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg">
                        <i class="fas fa-volume-up mr-2"></i>ç™ºéŸ³ã‚’èã
                    </button>
                </div>
            `;
            
            document.getElementById('phraseContent').innerHTML = content;
            updateUI();
            
            // Show Emi encouragement
            setTimeout(() => {
                document.getElementById('emiMessage').innerHTML = `æ–°ã—ã„ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’è¦šãˆãŸã­ï¼<br>ãƒã‚¤ãƒ†ã‚£ãƒ–ã¿ãŸã„ã«è©±ã›ãã†ğŸ‰`;
                document.getElementById('emiSpeech').style.display = 'block';
                setTimeout(() => document.getElementById('emiSpeech').style.display = 'none', 3000);
            }, 1000);
        }

        function startQuickTest() {
            let questionCount = parseInt(document.getElementById('testQuestionCount').value);
            let level = currentLevel === 'undiagnosed' ? 'beginner' : currentLevel;
            
            document.getElementById('quickTestArea').style.display = 'block';
            document.getElementById('quickTestArea').scrollIntoView();
            
            generateQuickTest(questionCount, level);
            
            // Show Emi encouragement
            document.getElementById('emiMessage').innerHTML = `${questionCount}å•ãƒ†ã‚¹ãƒˆã«æŒ‘æˆ¦ã ã­ï¼<br>é ‘å¼µã£ã¦ğŸ’ª`;
            document.getElementById('emiSpeech').style.display = 'block';
            setTimeout(() => document.getElementById('emiSpeech').style.display = 'none', 3000);
        }

        function generateQuickTest(questionCount, level) {
            let allWords = [];
            Object.keys(vocabulary[level]).forEach(category => {
                allWords = allWords.concat(vocabulary[level][category]);
            });
            
            let questions = [];
            for (let i = 0; i < questionCount; i++) {
                let word = allWords[Math.floor(Math.random() * allWords.length)];
                let options = [word.meaning];
                
                // Generate wrong options
                while (options.length < 4) {
                    let wrongWord = allWords[Math.floor(Math.random() * allWords.length)];
                    if (!options.includes(wrongWord.meaning)) {
                        options.push(wrongWord.meaning);
                    }
                }
                
                // Shuffle options
                options = options.sort(() => Math.random() - 0.5);
                let correctIndex = options.indexOf(word.meaning);
                
                questions.push({
                    word: word.word,
                    example: word.example,
                    options: options,
                    correct: correctIndex
                });
            }
            
            let testHtml = '<div class="space-y-6">';
            questions.forEach((q, index) => {
                testHtml += `
                    <div class="question-card p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">å•é¡Œ ${index + 1}: "${q.word}" ã®æ„å‘³ã¯ï¼Ÿ</h4>
                        <p class="text-sm text-gray-600 mb-3 italic">"${q.example}"</p>
                        <div class="grid grid-cols-2 gap-2">
                `;
                q.options.forEach((option, optIndex) => {
                    testHtml += `
                        <label class="flex items-center space-x-2 cursor-pointer hover:bg-gray-100 p-2 rounded">
                            <input type="radio" name="test_q${index}" value="${optIndex}" class="text-blue-500">
                            <span>${option}</span>
                        </label>
                    `;
                });
                testHtml += '</div></div>';
            });
            testHtml += `
                <div class="text-center">
                    <button onclick="submitQuickTest(${JSON.stringify(questions).replace(/"/g, '&quot;')})" class="bg-orange-500 hover:bg-orange-600 text-white px-8 py-3 rounded-lg font-medium">
                        <i class="fas fa-check mr-2"></i>ãƒ†ã‚¹ãƒˆçµæœã‚’è¦‹ã‚‹
                    </button>
                </div>
            </div>`;
            
            document.getElementById('testContent').innerHTML = testHtml;
        }

        function submitQuickTest(questions) {
            let correctAnswers = 0;
            let results = [];
            
            questions.forEach((q, index) => {
                let selected = document.querySelector(`input[name="test_q${index}"]:checked`);
                let isCorrect = selected && parseInt(selected.value) === q.correct;
                if (isCorrect) correctAnswers++;
                
                results.push({
                    word: q.word,
                    selected: selected ? q.options[selected.value] : "æœªå›ç­”",
                    correct: q.options[q.correct],
                    isCorrect: isCorrect
                });
            });
            
            let score = Math.round((correctAnswers / questions.length) * 100);
            
            // Update statistics
            testScores.push(score);
            totalTests++;
            localStorage.setItem('testScores', JSON.stringify(testScores));
            localStorage.setItem('totalTests', totalTests);
            
            showTestResults(results, score, questions.length);
            updateUI();
        }

        function showTestResults(results, score, totalQuestions) {
            let resultColor = score >= 80 ? 'text-green-600' : score >= 60 ? 'text-yellow-600' : 'text-red-600';
            let resultEmoji = score >= 80 ? 'ğŸ‰' : score >= 60 ? 'ğŸ‘' : 'ğŸ’ª';
            
            let resultHtml = `
                <div class="text-center mb-6">
                    <div class="text-6xl mb-4">${resultEmoji}</div>
                    <h3 class="text-2xl font-bold mb-2">ãƒ†ã‚¹ãƒˆçµæœ</h3>
                    <div class="text-3xl font-bold ${resultColor} mb-4">${score}%</div>
                    <p class="text-gray-600">${results.filter(r => r.isCorrect).length}/${totalQuestions} å•æ­£è§£</p>
                </div>
                
                <div class="space-y-3 mb-6">
                    <h4 class="font-semibold text-lg">è©³ç´°çµæœ:</h4>
            `;
            
            results.forEach((result, index) => {
                let bgColor = result.isCorrect ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200';
                let icon = result.isCorrect ? 'âœ…' : 'âŒ';
                
                resultHtml += `
                    <div class="${bgColor} border p-3 rounded-lg">
                        <div class="flex items-center justify-between">
                            <span class="font-medium">${icon} ${result.word}</span>
                        </div>
                        <div class="text-sm text-gray-600 mt-1">
                            ã‚ãªãŸã®å›ç­”: ${result.selected}<br>
                            æ­£è§£: ${result.correct}
                        </div>
                    </div>
                `;
            });
            
            resultHtml += `
                </div>
                <div class="text-center">
                    <button onclick="closeTest()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg mr-3">
                        <i class="fas fa-home mr-2"></i>ãƒ¡ã‚¤ãƒ³ã«æˆ»ã‚‹
                    </button>
                    <button onclick="startQuickTest()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg">
                        <i class="fas fa-redo mr-2"></i>ã‚‚ã†ä¸€åº¦ãƒ†ã‚¹ãƒˆ
                    </button>
                </div>
            `;
            
            document.getElementById('testContent').innerHTML = resultHtml;
            
            // Show Emi message
            let emiMessage = score >= 80 ? `ç´ æ™´ã‚‰ã—ã„ï¼${score}%ã®é«˜å¾—ç‚¹âœ¨<br>è‹±èªåŠ›ãŒã‚¢ãƒƒãƒ—ã—ã¦ã‚‹ã­ï¼` :
                           score >= 60 ? `è‰¯ã„çµæœï¼${score}%ã ã­ğŸ‘<br>ã“ã®èª¿å­ã§é ‘å¼µã‚ã†ï¼` :
                           `${score}%ã ã£ãŸã­ğŸ’ª<br>å¾©ç¿’ã—ã¦æ¬¡å›é ‘å¼µã‚ã†ï¼`;
            
            setTimeout(() => {
                document.getElementById('emiMessage').innerHTML = emiMessage;
                document.getElementById('emiSpeech').style.display = 'block';
                setTimeout(() => document.getElementById('emiSpeech').style.display = 'none', 4000);
            }, 1000);
        }

        function closeTest() {
            document.getElementById('quickTestArea').style.display = 'none';
        }

        function speakWord(word) {
            if ('speechSynthesis' in window) {
                let utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        function speakPhrase(phrase) {
            if ('speechSynthesis' in window) {
                let utterance = new SpeechSynthesisUtterance(phrase);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        // Auto-save progress periodically
        setInterval(() => {
            localStorage.setItem('lastVisit', new Date().toISOString());
        }, 60000); // Every minute
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDvaxDjnkuw6xz5V9oYz1ldc1Ng93O7hORX11BvjTg5Fj2fxsJmp75ViAYrRTXZyfBiw26z13dQnKqB0LjRK64aCcDC4x%2FdZzF%2BhVfSUF6XchiFoerpOv%2FUbGHor8ZZyNaJqLpHUo0QFUvgylzxgZsRXxscGxECAon2nUpr0G%2BIx%2Fn0eN00ex1Wtbj7oDFNcP%2FxKaYmDrhCoHqmguPYWJ62bov6jjTiQAaX%2FfX3tZS4xM3wfeVuJvUy1xo99bkumOGXGFsYHDjQMQk%2BV1yKkp33fxeoDyCVOPQEfqgN5B%2FeTtOq3LJ0747TocFnuIaxOdbBt5ko2MgDP1bSBsP2Y8GOeDrBy4pOp5afHD0Mt%2FtPEgEU6t7Md3LOW4Z701ui5PM44mPd6pwG42jVeCjYACsB%2F0BRzH%2BjXRVZ8BDo%2Fg8lbkks6raNqsFM%2B66mLK2MAdzOpJXrKPSSGtH42SERw1rkdjN%2BVMkWC3WMh4s%2BNxAqNmiBtX1CExo83x5ZXJwArT5fAzH7zfej5ywQ2j9uecpx0%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDvaxDjnkuw6xz5V9oYz1ldc1Ng93O7hORX11BvjTg5Fj2fxsJmp75ViAYrRTXZyfBiw26z13dQnKqB0LjRK64aCcDC4x/dZzF+hVfSUF6XchiFoerpOv/UbGHor8ZZyNaJqLpHUo0QFUvgylzxgZsRXxscGxECAon2nUpr0G+Ix/n0eN00ex1Wtbj7oDFNcP/xKaYmDrhCoHqmguPYWJ62bov6jjTiQAaX/fX3tZS4xM3wfeVuJvUy1xo99bkumOGXGFsYHDjQMQk+V1yKkp33fxeoDyCVOPQEfqgN5B/eTtOq3LJ0747TocFnuIaxOdbBt5ko2MgDP1bSBsP2Y8GOeDrBy4pOp5afHD0Mt/tPEgEU6t7Md3LOW4Z701ui5PM44mPd6pwG42jVeCjYACsB/0BRzH+jXRVZ8BDo/g8lbkks6raNqsFM+66mLK2MAdzOpJXrKPSSGtH42SERw1rkdjN+VMkWC3WMh4s+NxAqNmiBtX1CExo83x5ZXJwArT5fAzH7zfej5ywQ2j9uecpx0=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    